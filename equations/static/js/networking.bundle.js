(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{63:function(e,t){},69:function(e,t,n){var o=n(6),r=n(70);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};o(r,i);e.exports=r.locals||{}},70:function(e,t,n){"use strict";n.r(t);var o=n(4),r=n.n(o)()(!1);r.push([e.i,"\n.ChatMessages-module__boldMessageText--1gmuyULK {\n    font-weight: bold;\n    font-style: italics;\n}\n\n.ChatMessages-module__messageSender--pQZAFmiz {\n    font-weight: bold;\n}",""]),r.locals={boldMessageText:"ChatMessages-module__boldMessageText--1gmuyULK",messageSender:"ChatMessages-module__messageSender--pQZAFmiz"},t.default=r},71:function(e,t,n){"use strict";n.r(t),n.d(t,"socket",(function(){return Fe})),n.d(t,"connect",(function(){return Ue})),n.d(t,"sendChatMessage",(function(){return Ve})),n.d(t,"emitCubeClicked",(function(){return Xe})),n.d(t,"bonusButtonCallback",(function(){return $e}));var o=n(37),r=n.n(o),i=n(0),a=n.n(i),c=n(3),l=n.n(c),s=n(66),u=n.n(s),d=n(69),f=n.n(d);function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function h(e){var t="instruction"===e.type?f.a.boldMessageText:"";return a.a.createElement(a.a.Fragment,null,a.a.createElement("span",{className:f.a.messageSender},e.name,": "),a.a.createElement("span",{className:t},e.message," "))}function v(e){return a.a.createElement("button",{idName:"new_shake_button",onClick:e.onClick},e.buttonText)}function p(){return a.a.createElement(h,{name:"Server",message:"".concat("Five minute warning! If the cubes have been rolled, ").concat("continue your game -- you have five minutes left. ").concat("Do not start a new shake."),type:"five_min_warning"})}function _(e){var t=m(Object(i.useState)("unselected"),2),n=t[0],o=t[1],r="yes"===n||"no"===n,c={className:"yes"===n?"button-clicked":"",onClick:r?null:function(){o("yes"),e.onYesClick()}},l={className:"no"===n?"button-clicked":"",onClick:r?null:function(){o("no"),e.onNoClick()}};return a.a.createElement(a.a.Fragment,null,a.a.createElement("button",c,"Yes"),a.a.createElement("button",l,"No"))}function y(e){return e.isGamePlayer?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,e.solution),a.a.createElement(_,{onYesClick:e.onYesClick,onNoClick:e.onNoClick})):a.a.createElement("p",null,e.solution)}function b(e){var t=m(Object(i.useState)(""),2),n=t[0],o=t[1],r=m(Object(i.useState)(!1),2),c=r[0],l=r[1],s=["solution_submit"];return c&&s.push("hidden"),a.a.createElement(a.a.Fragment,null,a.a.createElement("input",{className:"solution_box",placeholder:"Type your solution here...",onChange:function(e){return o(e.target.value)},disabled:c}),a.a.createElement("button",{className:s.join(" "),onClick:function(){c||(l(!0),e.onSubmit(n))}},"Submit Solution"))}function w(e,t){document.getElementById("message-list").appendChild(e),l.a.render(t,e);var n=document.getElementById("message-list-div");n.scrollTop=n.scrollHeight}function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"player_message",o=document.createElement("li");w(o,a.a.createElement(h,{name:e,message:t,type:n}))}function E(e){k("Server",e,"server_message")}function C(e){E("Please submit your solution here:");var t=document.createElement("li");t.classList.add("solution_li"),w(t,a.a.createElement(b,{onSubmit:function(t){return e.emit("solution_submitted",t)}}))}function I(e,t,n,o,r){E(r?o?t+" does not agree that the solution is incorrect. Please re-evaluate whether you accept.":t+" submitted the following solution. Do you accept?":t+" submitted the following solution. Waiting for players to accept/reject.");var i=document.createElement("li");i.classList.add("chat-button"),w(i,a.a.createElement(y,{solution:n,isGamePlayer:r,onYesClick:function(){return e.emit("decided",{name:t,accepted:!0})},onNoClick:function(){return e.emit("decided",{name:t,accepted:!1})}}))}function S(e){E("The shake has ended due to a No Goal. Click below to restart the shake.");var t=document.createElement("li");t.classList.add("chat-button"),w(t,a.a.createElement(v,{buttonText:"Restart Shake",onClick:function(){return e.emit("restart_shake")}}))}h.propTypes={name:u.a.string.isRequired,message:u.a.string.isRequired,type:u.a.oneOf(["player_message","server_message","instruction","new_shake","five_min_warning","solution_check","solution_prompt"]).isRequired},h.defaultProps={type:"player_message"},v.propTypes={buttonText:u.a.string.isRequired,onClick:u.a.func.isRequired},_.propTypes={onYesClick:u.a.func.isRequired,onNoClick:u.a.func.isRequired},y.propTypes={solution:u.a.string.isRequired,isGamePlayer:u.a.bool.isRequired,onYesClick:u.a.func,onNoClick:u.a.func},b.propTypes={onSubmit:u.a.func.isRequired};var x,T,L,B,M,N,q,j,A=n(1);function D(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r,i=!0,a=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){a=!0,r=e},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw r}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var P,H,R,W,G=!1,Y=[];function F(){(x=document.getElementById("goal-sector")).width=.33*window.innerWidth,x.height=.09*window.innerHeight,T=x.getBoundingClientRect(),L=T.left,B=T.top,M=.1*x.width,N=M+3,q=M+2,j=x.height/8}function z(e,t,n){return t>e.cube_pos_x&&t<e.cube_pos_x+N&&n>j&&n<j+q}function U(e){return e=Math.min(e,x.width-N),e=Math.max(e,4)}function V(e){console.log("mouse down"),e.preventDefault(),e.stopPropagation();var t=parseInt(e.clientX-L),n=parseInt(e.clientY-B);G=!1;for(var o=Y.length-1;o>=0;o--){var r=Y[o];if(z(r,t,n)){G=!0,r.isDragging=!0;break}}P=t}function X(e){console.log("mouse up"),e.preventDefault(),e.stopPropagation(),G=!1;for(var t=0;t<Y.length;t++)if(Y[t].isDragging)return Y[t].isDragging=!1,void Fe.emit("x_pos_update",{order:t,x_pos_per_mille:Y[t].cube_pos_x/(x.width/1e3)})}function $(e){if(G){e.preventDefault(),e.stopPropagation();for(var t=parseInt(e.clientX-L),n=t-P,o=0;o<Y.length;o++){var r=Y[o];if(r.isDragging){r.cube_pos_x=U(r.cube_pos_x+n);break}}K(),P=t}}function J(e){e.preventDefault(),e.stopPropagation();for(var t=parseInt(e.clientX-L),n=parseInt(e.clientY-B),o=Y.length-1;o>=0;o--){var r=Y[o];if(z(r,t,n)){r.orientation=(r.orientation+90)%360,Fe.emit("orientation_update",{order:o,orientation:r.orientation});break}}return K(),!1}function K(){var e=x.getContext("2d");!function(e){e.clearRect(0,0,x.width,x.height)}(e),e.strokeStyle="#fff",e.lineWidth=2.5;for(var t=0;t<Y.length;t++){var n=Y[t];console.log("Calling draw rotated on ",n),Q(e,n.cube,n.cube_pos_x,j,M,M,n.orientation)}}function Q(e,t,n,o,r,i,a){e.save(),e.translate(n+r/2,o+i/2),e.rotate(a*Math.PI/180),console.log("Drawing the image!"),e.drawImage(t,-r/2,-i/2,r,i),function(e,t,n,o,r,i,a,c){if(void 0===c&&(c=!0),void 0===i&&(i=5),"number"==typeof i)i={tl:i,tr:i,br:i,bl:i};else{var l={tl:0,tr:0,br:0,bl:0};for(var s in l)i[s]=i[s]||l[s]}e.beginPath(),e.moveTo(t+i.tl,n),e.lineTo(t+o-i.tr,n),e.quadraticCurveTo(t+o,n,t+o,n+i.tr),e.lineTo(t+o,n+r-i.br),e.quadraticCurveTo(t+o,n+r,t+o-i.br,n+r),e.lineTo(t+i.bl,n+r),e.quadraticCurveTo(t,n+r,t,n+r-i.bl),e.lineTo(t,n+i.tl),e.quadraticCurveTo(t,n,t+i.tl,n),e.closePath(),a&&e.fill(),c&&e.stroke()}(e,-r/2-1,-i/2-1,r+3,i+2,7),e.restore()}function Z(e){console.log("resize function called"),e.preventDefault(),e.stopPropagation();var t=x.width;x.width=.33*window.innerWidth,x.height=.09*window.innerHeight,T=x.getBoundingClientRect(),L=T.left,B=T.top,M=.1*x.width,N=M+3,q=M+2,j=x.height/8,function(e){for(var t=0;t<Y.length;t++)console.log("OLD: ",Y[t].cube_pos_x/(e/1e3)),Y[t].cube_pos_x=U(Y[t].cube_pos_x*(x.width/e)),Fe.emit("x_pos_update",{order:t,x_pos_per_mille:Y[t].cube_pos_x/(x.width/1e3)}),console.log("NEW: ",Y[t].cube_pos_x/(x.width/1e3))}(t),K()}var ee,te=!1;function ne(e){H=e;var t=setInterval((function(){var e=new Date,n=Math.round(e.getTime()/1e3)-H,o=Math.floor(n/60),r=Math.floor(n%60),i="";o<10&&(i="0");var a="";r<10&&(a="0");var c="".concat(i).concat(o,":").concat(a).concat(r);o>=30&&!te&&(te=!0,Fe.emit("five_minute_warning")),o>=35&&(clearInterval(t),Fe.emit("game_time_up"),c="35:00"),R||(R=document.getElementById("elapsed")),R.innerHTML=c}),1e3)}function oe(e){e&&(clearInterval(ee),ee=setInterval((function(){var t=new Date,n=60-Math.floor(t.getTime()/1e3-e),o="";n<10&&(o="0");var r="0:".concat(o).concat(n);n<=0&&(clearInterval(ee),r="0:00"),W||(W=document.getElementsByClassName("display-time-div")[0]),W.innerHTML="<p>".concat(r,"</p>")}),1e3))}var re=new Map([["forbidden-sector","f"],["permitted-sector","p"],["required-sector","q"],["goal-sector","g"]]),ie={"forbidden-sector":0,"permitted-sector":0,"required-sector":0,"goal-sector":0};function ae(e){console.log("Rolling cubes!");for(var t=document.getElementById("resources-cubes"),n=function(n){if(-1===e[n])return"continue";var o=t.querySelector("#r".concat(n)),r=Object(A.b)(n,e);r.onmouseover=function(){r.classList.add("show-border")},r.onmouseout=function(){r.classList.remove("show-border")},r.onclick=function(){return Xe(n)},o.appendChild(r)},o=0;o<e.length;++o)n(o);console.log("Finished rolling cubes")}function ce(e,t){e.length>6&&console.log("Something is wrong! Server stored more than 6 cubes in goal!"),ie["goal-sector"]=e.length,function(e,t){window.onresize=Z;var n,o=D(e);try{for(o.s();!(n=o.n()).done;){var r=n.value;Object(A.b)(r.idx,t).onload=K,Y.push({order:Y.length,idx:r.idx,cube:Object(A.b)(r.idx,t),cube_pos_x:U(r.x*x.width/1e3),isDragging:!1,orientation:r.orientation})}}catch(e){o.e(e)}finally{o.f()}}(e,t)}function le(e,t,n){for(var o=0,r=[12,16,20];o<r.length;o++){var i=r[o];e.length>i&&he(t,i)}ie[t]=e.length,function(e,t,n){for(var o=0;o<e.length;++o){var r=document.getElementById("".concat(re.get(t)).concat(o)),i=e[o];r.appendChild(Object(A.b)(i,n))}}(e,t,n)}function se(){Y.length=0,K(),ie["goal-sector"]=0}function ue(e){for(var t=document.getElementById(e).querySelector("table"),n=t.rows.length-1;n>=3;--n)t.deleteRow(n);for(var o=0;o<12;++o){t.querySelector("#".concat(re.get(e)).concat(o)).innerHTML=""}ie[e]=0}function de(e){for(var t=document.getElementById("scoreboard"),n=0;n<e.length;++n)t.rows[0].cells.item(n).innerHTML=e[n];for(var o=e.length;o<3;++o)t.rows[0].cells.item(o).innerHTML="--------";return t}function fe(e,t,n,o){2===e.rows.length&&0==e.rows[1].cells[0].innerHTML&&e.deleteRow(1);var r=e.insertRow();r.insertCell().innerHTML=t,r.insertCell().innerHTML=n,r.insertCell().innerHTML=o}function me(e){document.getElementById("actual-turn-text").innerHTML="".concat(e)}function ge(e){var t=e.from,n=ie[e.to],o="".concat(re.get(e.to)).concat(n);12!==n&&16!==n&&20!==n||he(e.to,n),ie[e.to]++;var r=document.getElementById("resources-cubes").querySelector("#r".concat(t)).querySelector("img");r.onmouseover=function(){},r.onmouseout=function(){},r.onclick=function(){},r.classList.remove("highlight-img"),"goal-sector"===e.to?function(e,t){var n=x.width/100;0!==Y.length&&(n+=Y.length*(3*n+N));var o=Y.length;Y.push({order:o,idx:e,cube:t.cloneNode(!0),cube_pos_x:n,isDragging:!1,orientation:0}),t.remove(),Fe.emit("x_pos_update",{order:o,x_pos_per_mille:n/(x.width/1e3)}),K()}(e.from,r):document.getElementById(o).appendChild(r),pe(!1)}function he(e,t){for(var n=document.getElementById(e).querySelector("table").insertRow(),o=0;o<4;++o){n.insertCell().id="".concat(re.get(e)).concat(t+o)}}var ve=function(e){!function(e,t,n,o){if(void 0!==t){t.length===n.length&&n.length==o.length||console.log("Something is messed up with the scores! Not of same length!");for(var r=0;r<t.length;++r)fe(e,t[r],n[r],o[r])}}(de(e.players),e.p1scores,e.p2scores,e.p3scores),e.game_finished?me("Game Ended"):e.game_started?(me(e.players[e.turn]),ne(e.starttime),oe(e.last_timer_flip)):me("Not Started"),e.game_started&&(document.getElementById("start_game").remove(),F(),e.goalset&&_e(),ae(e.resources),ce(e.goal,e.cube_index),le(e.forbidden,"forbidden-sector",e.cube_index),le(e.permitted,"permitted-sector",e.cube_index),le(e.required,"required-sector",e.cube_index))};function pe(e){var t=document.getElementById("bonus-button");t.classList.remove("button-clicked"),e?(t.classList.remove("hidden"),t.onclick=$e.bind(t)):(t.classList.add("hidden"),t.onclick=function(){})}function _e(){var e=document.getElementById("no_goal");e.classList.add("hidden"),e.onclick=function(){return console.log("No goal challenge somehow clicked...")};var t=document.getElementById("set-goal-button");t.classList.add("hidden"),t.onclick=function(){return console.log("Set goal button somehow clicked...")},x.onmousedown=function(){},x.onmouseup=function(){},x.onmousemove=function(){},x.oncontextmenu=function(){}}function ye(){console.log("Clearing board"),se();for(var e=0,t=["forbidden-sector","permitted-sector","required-sector"];e<t.length;e++){ue(t[e])}!function(){for(var e=document.getElementById("resources-cubes"),t=0;t<24;++t){e.querySelector("#r".concat(t)).innerHTML=""}}()}function be(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return we(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r,i=!0,a=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){a=!0,r=e},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw r}}}}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var ke=["forbidden-sector","permitted-sector","required-sector","goal-sector"],Ee=["flip_timer","claim_warning","claim_minus_one","a_flub","p_flub","no_goal"];var Ce=function(e,t,n,o){if(F(),window.onresize=Z,o&&n===t){var r=document.getElementById("set-goal-button");r.classList.remove("hidden"),r.onclick=function(){e.emit("set_goal")},x.onmousedown=V,x.onmouseup=X,x.onmousemove=$,x.oncontextmenu=J}};function Ie(e,t){var n,o=be(ke);try{var r=function(){var t=n.value;document.getElementById(t).onclick=function(){console.log("".concat(t," clicked")),e.emit("sector_clicked",t)}};for(o.s();!(n=o.n()).done;)r()}catch(e){o.e(e)}finally{o.f()}!function(e){var t,n=Se(),o=be(Ee);try{for(o.s();!(t=o.n()).done;){var r=t.value;xe(e,n.querySelector("#".concat(r)),r)}}catch(e){o.e(e)}finally{o.f()}}(e),pe(t)}function Se(){var e=document.getElementById("buttons-div");if(0===e.length)throw Error("Error finding buttons on page!?");return e}function xe(e,t,n){t.onclick=function(){console.log("Button for ".concat(n," clicked!")),e.emit(n)}}function Te(){var e,t,n=be(ke);try{for(n.s();!(e=n.n()).done;){var o=e.value;document.getElementById(o).onclick=function(){}}}catch(e){n.e(e)}finally{n.f()}!function(){var e,t=Se(),n=be(Ee);try{for(n.s();!(e=n.n()).done;){var o=e.value;t.querySelector("#".concat(o)).onclick=function(){}}}catch(e){n.e(e)}finally{n.f()}}(),(t=document.getElementById("set-goal-button")).classList.add("hidden"),t.onclick=function(){},pe(!1)}var Le=new Map([["a_flub","Challenge Now"],["p_flub","Challenge Impossible"],["no_goal","No Goal Declared"],["force_out","Last Cube Procedure"]]);function Be(e,t,n,o){n&&(me(Le.get(n.challenge)),"finished"===n.endgame_stage?De(e,t,o):"no_goal_finished"===n.endgame_stage?function(e,t,n){n.includes(t)?(E("Click here to restart the shake: "),S(e)):E("Waiting for players to restart the shake...")}(e,t,o):(function(e){var t=e.challenge;if("force_out"===t)E("The players are currently in a Force Out...");else if("no_goal"===t)E("A No Goal has been declared...");else{var n="".concat(e.challenger," has called "),o="".concat(Le.get(t)," on ").concat(e.last_mover,".");E("".concat(n).concat(o))}}(n),"waiting_for_reviewers"===n.endgame_stage?(je(e,t,{solutions:n.solutions,players:o}),function(e,t,n){for(var o in n.review_status)if(n.review_status.hasOwnProperty(o))for(var r in n.review_status[o]){if(n.review_status[o].hasOwnProperty(r))"ASSENTING"===n.review_status[o][r]&&Ae(e,t,{rejecter:o,writer:r})}}(e,t,n)):"no_goal"==n.challenge?Me(e,n.caller,n.writers,n.nonwriters,t):(Ne(e,n.sider,t),qe(e,n.writers,t))))}function Me(e,t,n,o,r){r===t?E("Waiting for other player to agree or disagree with your No Goal declaration..."):o.includes(r)?E("Waiting for one more player to agree or disagree with the No Goal declaration..."):n.includes(r)?C(e):function(e,t){E(t+" claims no goal can be set which has at least one correct solution. Do you agree? If not, you can challenge the No Goal declaration and you will have two minutes to write a correct Solution & Goal. Disagreeing with the no goal declaration is considered a challenge, so the first player to disagree (if a player disagrees) will be deemed the challenger.");var n=document.createElement("li");n.classList.add("chat-button"),w(n,a.a.createElement(_,{onYesClick:function(){return e.emit("no_goal_sided",!0)},onNoClick:function(){e.emit("no_goal_sided",!1),C(e)}}))}(e,t)}function Ne(e,t,n){null!=t&&(t===n?function(e){E("Do you wish to write a solution? You have one minute to decide.");var t=document.createElement("li");t.classList.add("chat-button"),w(t,a.a.createElement(_,{onYesClick:function(){e.emit("sided",!0),C(e)},onNoClick:function(){return e.emit("sided",!1)}}))}(e):E("Waiting for ".concat(t," to side...")))}function qe(e,t,n){t.includes(n)?C(e):E("Waiting for solutions to be submitted....")}function je(e,t,n){E("Time to review solutions!");var o=n.solutions,r=n.players,i=!1;for(var a in o)a!==t&&(i=!0,I(e,a,o[a],!1,r.includes(t)));i||E("Waiting for others to finish reviewing solutions...")}function Ae(e,t,n){var o=n.rejecter,r=n.writer;r===t?function(e,t){E(t+" rejected your solution. Do you agree?");var n=document.createElement("li");n.classList.add("chat-button"),w(n,a.a.createElement(_,{onYesClick:function(){return e.emit("assented",{rejecter:t,assented:!0})},onNoClick:function(){return e.emit("assented",{rejecter:t,assented:!1})}}))}(e,o):E("Waiting for ".concat(r," to accept the rejection..."))}function De(e,t,n){n.includes(t)?(E("Click here to start a new shake: "),function(e){var t=document.createElement("li");t.classList.add("chat-button"),w(t,a.a.createElement(v,{buttonText:"Start New Shake",onClick:function(){return e.emit("new_shake")}}))}(e)):E("Waiting for players to start a new shake...")}function Oe(e,t,n,o){var r=document.getElementById("variations");if(r.classList.remove("hidden"),r.querySelector("#called-variations").innerHTML=t.variations.join(", "),t.num_players_called<n.length)if(me("Calling Variations"),n[t.caller_index]===o){var i=document.getElementById("variations-input-div");i.classList.remove("hidden");var a=i.getElementsByTagName("button")[0];a.onclick=function(){var t=i.getElementsByTagName("input")[0];e.emit("variation_called",{player:o,content:t.value}),t.value="",i.classList.add("hidden"),a.onclick=function(){}},E('It is your turn to call variations. Please enter the variations you want to call in the text box to the left (in the "Variations" section), and hit "Submit" when you are done!')}else E("It is ".concat(n[t.caller_index],"'s turn to call variations. Waiting \n                for ").concat(n[t.caller_index]," to finish calling variations..."));else console.log("The variation calling stage has already finished")}function Pe(e){ve(e),Oe(socket,e.variations_state,e.players,name),Be(socket,name,e.endgame,e.players)}function He(e){ve(e),e.game_finished||(e.game_started?(Ie(socket,function(e,t){if(e.players[e.turn]!=t)return!1;if(e.challenge)return!1;if(n=Object.values(ie).reduce((function(e,t){return e+t})),console.log("cubes not in resources: ",n),24-n<2)return!1;var n;if(e.started_move)return!1;var o=e.players.findIndex((function(e){return e===t}));if(-1===o)return console.log("Error! Player not in game in render_player_state"),!1;for(var r=function(e,t){return e+t},i=e["p".concat(o+1,"scores")].reduce(r),a=e.p1scores.reduce(r),c=e.p2scores.reduce(r),l=e.p3scores.reduce(r),s=0,u=0,d=[a,c,l];u<d.length;u++){i>d[u]&&++s}if(2===s)return!1;return!0}(e,name)),Ce(socket,name,e.players[e.turn],!e.goalset),Oe(socket,e.variations_state,e.players,name),Be(socket,name,e.endgame,e.players),console.log("challenge recorded: ",e.challenge),"no_goal"===e.challenge&&_e()):(function(e){Se().querySelector("#start_game").onclick=function(){console.log("Button for start_game clicked!"),e.emit("start_game")}}(socket),function(e,t,n){if(!t.tournament&&t.players.includes(n)){var o=document.createElement("button");o.innerHTML="Leave Game",o.onclick=function(){e.emit("leave_game")};var r=document.createElement("a");r.id="leave_game_anchor",r.href="/",r.appendChild(o),document.getElementById("buttons-div").appendChild(r)}}(socket,e,name)))}function Re(e){var t=e.cubes;document.getElementById("start_game").remove();var n=document.getElementById("leave_game_anchor");n&&n.remove(),E("".concat(e.starter," started the game! The cubes have been rolled!")),E("".concat(e.goalsetter," is chosen to be the goalsetter.")),Oe(socket,e.variations_state,e.players,name),ne(e.starttime),ae(t),fe(de(e.players),0,0,0);var o=e.goalsetter;Ie(socket,o===name),Ce(socket,name,o,!0)}function We(e){var t=document.getElementById("new_shake_button");t&&t.remove(),E("A new shake has started! ".concat(e.goalsetter," is chosen to be the goalsetter.")),ye(),ae(e.cubes),Oe(socket,e.variations_state,e.players,name);var n=e.goalsetter;Ie(socket,n===name&&e.show_bonus),Ce(socket,name,n,!0)}function Ge(e){var t=e.player,n=e.show_bonus;me(t),pe(t===name&&n)}var Ye=window.location.protocol.includes("https")?"wss":"ws",Fe=r()("".concat(Ye,"://").concat(window.location.host),{reconnection:!1}),ze=new Promise((function(e){Fe.on("connect",(function(){console.log("Connected to server!"),e()}))})),Ue=function(){ze.then((function(){var e=document.getElementById("room-nonce").innerHTML,t=document.getElementById("name").innerHTML,n={room:e,name:t};!function(e){Fe.on("disconnect",(function(){return console.log("disconnected from room")})),Fe.on("message",(function(e){return k(e.name,e.message)})),Fe.on("server_message",(function(e){return E(e)})),Fe.on("render_spectator_state",(function(e){return Pe(e)})),Fe.on("render_player_state",(function(e){return He(e)})),Fe.on("new_player",de),Fe.on("player_left",de),Fe.on("begin_game",(function(e){return Re(e)})),Fe.on("begin_shake",(function(e){return We(e)})),Fe.on("next_turn",(function(e){return Ge(e)})),Fe.on("game_over_clientside",(function(){return E("The game has finished!"),me("Game Ended"),void Te()})),Fe.on("end_shake_no_goal",(function(){return S(Fe)})),Fe.on("hide_goal_setting_buttons",(function(){return _e()})),Fe.on("update_goalline",(function(e){return t=e.type,n=e.order,o=e.new_val,"x_pos"===t?Y[n].cube_pos_x=U(o*(x.width/1e3)):"orientation"===t&&(Y[n].orientation=o),void K();var t,n,o})),Fe.on("highlight_cube",(function(e){return t=e,void document.getElementById("r".concat(t)).querySelector("img").classList.add("highlight-img");var t})),Fe.on("unhighlight_cube",(function(e){return t=e,void document.getElementById("r".concat(t)).querySelector("img").classList.remove("highlight-img");var t})),Fe.on("move_cube",(function(e){return ge(e)})),Fe.on("handle_challenge",(function(t){return function(e,t,n){var o=n.challenge,r=n.writers,i=n.nonwriters,a=n.caller,c=n.sider;Te(),me(Le.get(o)),"no_goal"!==o?(Ne(e,c,t),qe(e,r,t)):Me(e,a,r,i,t)}(Fe,e,t)})),Fe.on("force_out",(function(t){return function(e,t,n){me("Force Out"),E("It is now Force Out."),n.includes(t)?(Te(),C(e)):E("Waiting for players to write solutions...")}(Fe,e,t)})),Fe.on("review_solutions",(function(t){return je(Fe,e,t)})),Fe.on("rejection_assent",(function(t){return Ae(Fe,e,t)})),Fe.on("reevaluate_solution",(function(t){return function(e,t,n){var o=n.rejecter,r=n.writer,i=n.solution;if(o===t)I(e,r,i,!0,!0);else{var a="".concat(r," does not agree that his/her solution "),c="is incorrect. Waiting for ".concat(o," to re-evaluate ");E("".concat(a).concat(c).concat("whether the solution is correct..."))}}(Fe,e,t)})),Fe.on("finish_shake",(function(t){return function(e,t,n,o){var r=n.p1score,i=n.p2score,a=n.p3score,c=n.players;E("This shake has finished! The scoreboard has been updated."),fe(document.getElementById("scoreboard"),r,i,a),o?e.emit("game_over"):De(e,t,c)}(Fe,e,t.scores,t.game_finished)})),Fe.on("five_minute_warning_message",(function(){w(document.createElement("li"),a.a.createElement(p,null))})),Fe.on("update_variations",(function(t){return Oe(Fe,t.variations_state,t.players,e)})),Fe.on("variations_finished",(function(e){return handleVariationsFinished(e)})),Fe.on("timer_flip",(function(e){return function(e){E("".concat(e.flipper," flipped the timer.")),oe(e.last_timer_flip)}(e)}))}(t),console.log("Connecting as ".concat(t," in room ").concat(e)),Fe.emit("register_client",n)})).catch((function(e){return console.log("Error: ",e)}))};function Ve(e){var t=document.getElementById("name").innerHTML;Fe.emit("new_message",{name:t,message:e})}var Xe=function(e){return Fe.emit("cube_clicked",e)};function $e(){this.classList.toggle("button-clicked"),Fe.emit("bonus_clicked")}}}]);