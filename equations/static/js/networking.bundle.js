(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{63:function(e,t){},69:function(e,t,n){var o=n(6),r=n(70);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};o(r,i);e.exports=r.locals||{}},70:function(e,t,n){"use strict";n.r(t);var o=n(4),r=n.n(o)()(!1);r.push([e.i,"\n.ChatMessage-module__boldMessageText--3hn1R-ZG {\n    font-weight: bold;\n    font-style: italics;\n}\n\n.ChatMessage-module__messageSender--15TnHX_2 {\n    font-weight: bold;\n}",""]),r.locals={boldMessageText:"ChatMessage-module__boldMessageText--3hn1R-ZG",messageSender:"ChatMessage-module__messageSender--15TnHX_2"},t.default=r},71:function(e,t,n){"use strict";n.r(t),n.d(t,"socket",(function(){return qe})),n.d(t,"connect",(function(){return Ae})),n.d(t,"sendChatMessage",(function(){return De})),n.d(t,"emitCubeClicked",(function(){return Ne})),n.d(t,"bonusButtonCallback",(function(){return Oe}));var o=n(37),r=n.n(o),i=n(0),a=n.n(i),c=n(3),l=n.n(c),s=n(66),u=n.n(s),d=n(69),f=n.n(d);function g(e){var t="instruction"===e.type?f.a.boldMessageText:"";return a.a.createElement(a.a.Fragment,null,a.a.createElement("span",{className:f.a.messageSender},e.name,": "),a.a.createElement("span",{className:t},e.message," "))}function m(e){return a.a.createElement("button",{idName:"new_shake_button",onClick:e.onClick},e.buttonText)}function h(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r,i=!0,a=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){a=!0,r=e},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw r}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function p(e,t){document.getElementById("message-list").appendChild(e),l.a.render(t,e);var n=document.getElementById("message-list-div");n.scrollTop=n.scrollHeight}function b(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"player_message",o=document.createElement("li");p(o,a.a.createElement(g,{name:e,message:t,type:n}))}function y(e,t){b(e,t,"instruction")}function _(e){b("Server",e,"server_message")}function w(e){var t,n=h(e);try{for(n.s();!(t=n.n()).done;){t.value.onclick=function(){}}}catch(e){n.e(e)}finally{n.f()}}function k(e){_("Please submit your solution here:");var t=document.createElement("li");t.classList.add("solution_li");var n=document.createElement("input");n.classList.add("solution_box"),n.placeholder="Type your solution here...";var o=document.createElement("button");o.classList.add("solution_submit"),o.innerHTML="Submit Solution",o.onclick=function(){e.emit("solution_submitted",n.value),n.disabled=!0,o.onclick=function(){},o.classList.add("hidden")},t.appendChild(n),t.appendChild(o),document.getElementById("message-list").appendChild(t)}function E(e,t,n,o,r){_(r?o?t+" does not agree that the solution is incorrect. Please re-evaluate whether you accept.":t+" submitted the following solution. Do you accept?":t+" submitted the following solution. Waiting for players to accept/reject.");var i=document.createElement("li");i.classList.add("chat-button");var a=document.createElement("p");if(a.innerHTML=n,i.append(a),r){var c=document.createElement("button");c.innerHTML="Yes",i.appendChild(c);var l=document.createElement("button");l.innerHTML="No",i.appendChild(l),c.onclick=function(){e.emit("decided",{name:t,accepted:!0}),w([c,l]),c.classList.add("button-clicked")},l.onclick=function(){e.emit("decided",{name:t,accepted:!1}),w([c,l]),l.classList.add("button-clicked")}}document.getElementById("message-list").appendChild(i)}function I(e){_("The shake has ended due to a No Goal. Click below to restart the shake.");var t=document.createElement("li");t.classList.add("chat-button"),p(t,a.a.createElement(m,{buttonText:"Restart Shake",onClick:function(){return e.emit("restart_shake")}}))}g.propTypes={name:u.a.string.isRequired,message:u.a.string.isRequired,type:u.a.oneOf(["player_message","server_message","instruction","new_shake"]).isRequired},g.defaultProps={type:"player_message"},m.propTypes={buttonText:u.a.string.isRequired,onClick:u.a.func.isRequired};var T,C,L,S,x,M,B,H,q=n(1);function j(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r,i=!0,a=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){a=!0,r=e},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw r}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var D,N,O,W=!1,P=[];function R(){(T=document.getElementById("goal-sector")).width=.33*window.innerWidth,T.height=.09*window.innerHeight,C=T.getBoundingClientRect(),L=C.left,S=C.top,x=.1*T.width,M=x+3,B=x+2,H=T.height/8}function G(e,t,n){return t>e.cube_pos_x&&t<e.cube_pos_x+M&&n>H&&n<H+B}function F(e){return e=Math.min(e,T.width-M),e=Math.max(e,4)}function Y(e){console.log("mouse down"),e.preventDefault(),e.stopPropagation();var t=parseInt(e.clientX-L),n=parseInt(e.clientY-S);W=!1;for(var o=P.length-1;o>=0;o--){var r=P[o];if(G(r,t,n)){W=!0,r.isDragging=!0;break}}D=t}function X(e){console.log("mouse up"),e.preventDefault(),e.stopPropagation(),W=!1;for(var t=0;t<P.length;t++)if(P[t].isDragging)return P[t].isDragging=!1,void qe.emit("x_pos_update",{order:t,x_pos_per_mille:P[t].cube_pos_x/(T.width/1e3)})}function z(e){if(W){e.preventDefault(),e.stopPropagation();for(var t=parseInt(e.clientX-L),n=t-D,o=0;o<P.length;o++){var r=P[o];if(r.isDragging){r.cube_pos_x=F(r.cube_pos_x+n);break}}$(),D=t}}function U(e){e.preventDefault(),e.stopPropagation();for(var t=parseInt(e.clientX-L),n=parseInt(e.clientY-S),o=P.length-1;o>=0;o--){var r=P[o];if(G(r,t,n)){r.orientation=(r.orientation+90)%360,qe.emit("orientation_update",{order:o,orientation:r.orientation});break}}return $(),!1}function $(){var e=T.getContext("2d");!function(e){e.clearRect(0,0,T.width,T.height)}(e),e.strokeStyle="#fff",e.lineWidth=2.5;for(var t=0;t<P.length;t++){var n=P[t];console.log("Calling draw rotated on ",n),J(e,n.cube,n.cube_pos_x,H,x,x,n.orientation)}}function J(e,t,n,o,r,i,a){e.save(),e.translate(n+r/2,o+i/2),e.rotate(a*Math.PI/180),console.log("Drawing the image!"),e.drawImage(t,-r/2,-i/2,r,i),function(e,t,n,o,r,i,a,c){if(void 0===c&&(c=!0),void 0===i&&(i=5),"number"==typeof i)i={tl:i,tr:i,br:i,bl:i};else{var l={tl:0,tr:0,br:0,bl:0};for(var s in l)i[s]=i[s]||l[s]}e.beginPath(),e.moveTo(t+i.tl,n),e.lineTo(t+o-i.tr,n),e.quadraticCurveTo(t+o,n,t+o,n+i.tr),e.lineTo(t+o,n+r-i.br),e.quadraticCurveTo(t+o,n+r,t+o-i.br,n+r),e.lineTo(t+i.bl,n+r),e.quadraticCurveTo(t,n+r,t,n+r-i.bl),e.lineTo(t,n+i.tl),e.quadraticCurveTo(t,n,t+i.tl,n),e.closePath(),a&&e.fill(),c&&e.stroke()}(e,-r/2-1,-i/2-1,r+3,i+2,7),e.restore()}function Z(e){console.log("resize function called"),e.preventDefault(),e.stopPropagation();var t=T.width;T.width=.33*window.innerWidth,T.height=.09*window.innerHeight,C=T.getBoundingClientRect(),L=C.left,S=C.top,x=.1*T.width,M=x+3,B=x+2,H=T.height/8,function(e){for(var t=0;t<P.length;t++)console.log("OLD: ",P[t].cube_pos_x/(e/1e3)),P[t].cube_pos_x=F(P[t].cube_pos_x*(T.width/e)),qe.emit("x_pos_update",{order:t,x_pos_per_mille:P[t].cube_pos_x/(T.width/1e3)}),console.log("NEW: ",P[t].cube_pos_x/(T.width/1e3))}(t),$()}var K=!1;function Q(e){N=e;var t=setInterval((function(){var e=new Date,n=Math.round(e.getTime()/1e3)-N,o=Math.floor(n/60),r=Math.floor(n%60),i="";o<10&&(i="0");var a="";r<10&&(a="0");var c="".concat(i).concat(o,":").concat(a).concat(r);o>=30&&!K&&(K=!0,qe.emit("five_minute_warning")),o>=35&&(clearInterval(t),qe.emit("game_time_up"),c="35:00"),O||(O=document.getElementById("elapsed")),O.innerHTML=c}),1e3)}var V=new Map([["forbidden-sector","f"],["permitted-sector","p"],["required-sector","q"],["goal-sector","g"]]),ee={"forbidden-sector":0,"permitted-sector":0,"required-sector":0,"goal-sector":0};function te(e){console.log("Rolling cubes!");for(var t=document.getElementById("resources-cubes"),n=function(n){if(-1===e[n])return"continue";var o=t.querySelector("#r".concat(n)),r=Object(q.b)(n,e);r.onmouseover=function(){r.classList.add("show-border")},r.onmouseout=function(){r.classList.remove("show-border")},r.onclick=function(){return Ne(n)},o.appendChild(r)},o=0;o<e.length;++o)n(o);console.log("Finished rolling cubes")}function ne(e,t){e.length>6&&console.log("Something is wrong! Server stored more than 6 cubes in goal!"),ee["goal-sector"]=e.length,function(e,t){window.onresize=Z;var n,o=j(e);try{for(o.s();!(n=o.n()).done;){var r=n.value;Object(q.b)(r.idx,t).onload=$,P.push({order:P.length,idx:r.idx,cube:Object(q.b)(r.idx,t),cube_pos_x:F(r.x*T.width/1e3),isDragging:!1,orientation:r.orientation})}}catch(e){o.e(e)}finally{o.f()}}(e,t)}function oe(e,t,n){for(var o=0,r=[12,16,20];o<r.length;o++){var i=r[o];e.length>i&&ue(t,i)}ee[t]=e.length,function(e,t,n){for(var o=0;o<e.length;++o){var r=document.getElementById("".concat(V.get(t)).concat(o)),i=e[o];r.appendChild(Object(q.b)(i,n))}}(e,t,n)}function re(){P.length=0,$(),ee["goal-sector"]=0}function ie(e){for(var t=document.getElementById(e).querySelector("table"),n=t.rows.length-1;n>=3;--n)t.deleteRow(n);for(var o=0;o<12;++o){t.querySelector("#".concat(V.get(e)).concat(o)).innerHTML=""}ee[e]=0}function ae(e){for(var t=document.getElementById("scoreboard"),n=0;n<e.length;++n)t.rows[0].cells.item(n).innerHTML=e[n];for(var o=e.length;o<3;++o)t.rows[0].cells.item(o).innerHTML="--------";return t}function ce(e,t,n,o){2===e.rows.length&&0==e.rows[1].cells[0].innerHTML&&e.deleteRow(1);var r=e.insertRow();r.insertCell().innerHTML=t,r.insertCell().innerHTML=n,r.insertCell().innerHTML=o}function le(e){document.getElementById("actual-turn-text").innerHTML="".concat(e)}function se(e){var t=e.from,n=ee[e.to],o="".concat(V.get(e.to)).concat(n);12!==n&&16!==n&&20!==n||ue(e.to,n),ee[e.to]++;var r=document.getElementById("resources-cubes").querySelector("#r".concat(t)).querySelector("img");r.onmouseover=function(){},r.onmouseout=function(){},r.onclick=function(){},r.classList.remove("highlight-img"),"goal-sector"===e.to?function(e,t){var n=T.width/100;0!==P.length&&(n+=P.length*(3*n+M));var o=P.length;P.push({order:o,idx:e,cube:t.cloneNode(!0),cube_pos_x:n,isDragging:!1,orientation:0}),t.remove(),qe.emit("x_pos_update",{order:o,x_pos_per_mille:n/(T.width/1e3)}),$()}(e.from,r):document.getElementById(o).appendChild(r),fe(!1)}function ue(e,t){for(var n=document.getElementById(e).querySelector("table").insertRow(),o=0;o<4;++o){n.insertCell().id="".concat(V.get(e)).concat(t+o)}}var de=function(e){!function(e,t,n,o){if(void 0!==t){t.length===n.length&&n.length==o.length||console.log("Something is messed up with the scores! Not of same length!");for(var r=0;r<t.length;++r)ce(e,t[r],n[r],o[r])}}(ae(e.players),e.p1scores,e.p2scores,e.p3scores),e.game_finished?le("Game Ended"):e.game_started?(le(e.players[e.turn]),Q(e.starttime)):le("Not Started"),e.game_started&&(document.getElementById("start_game").remove(),R(),e.goalset&&ge(),te(e.resources),ne(e.goal,e.cube_index),oe(e.forbidden,"forbidden-sector",e.cube_index),oe(e.permitted,"permitted-sector",e.cube_index),oe(e.required,"required-sector",e.cube_index))};function fe(e){var t=document.getElementById("bonus-button");t.classList.remove("button-clicked"),e?(t.classList.remove("hidden"),t.onclick=Oe.bind(t)):(t.classList.add("hidden"),t.onclick=function(){})}function ge(){var e=document.getElementById("no_goal");e.classList.add("hidden"),e.onclick=function(){return console.log("No goal challenge somehow clicked...")};var t=document.getElementById("set-goal-button");t.classList.add("hidden"),t.onclick=function(){return console.log("Set goal button somehow clicked...")},T.onmousedown=function(){},T.onmouseup=function(){},T.onmousemove=function(){},T.oncontextmenu=function(){}}function me(){console.log("Clearing board"),re();for(var e=0,t=["forbidden-sector","permitted-sector","required-sector"];e<t.length;e++){ie(t[e])}!function(){for(var e=document.getElementById("resources-cubes"),t=0;t<24;++t){e.querySelector("#r".concat(t)).innerHTML=""}}()}function he(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ve(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r,i=!0,a=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){a=!0,r=e},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw r}}}}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var pe=["forbidden-sector","permitted-sector","required-sector","goal-sector"],be=["flip_timer","claim_warning","claim_minus_one","a_flub","p_flub","no_goal"];var ye=function(e,t,n,o){if(R(),window.onresize=Z,o&&n===t){var r=document.getElementById("set-goal-button");r.classList.remove("hidden"),r.onclick=function(){e.emit("set_goal")},T.onmousedown=Y,T.onmouseup=X,T.onmousemove=z,T.oncontextmenu=U}};function _e(e,t){var n,o=he(pe);try{var r=function(){var t=n.value;document.getElementById(t).onclick=function(){console.log("".concat(t," clicked")),e.emit("sector_clicked",t)}};for(o.s();!(n=o.n()).done;)r()}catch(e){o.e(e)}finally{o.f()}!function(e){var t,n=we(),o=he(be);try{for(o.s();!(t=o.n()).done;){var r=t.value;ke(e,n.querySelector("#".concat(r)),r)}}catch(e){o.e(e)}finally{o.f()}}(e),fe(t)}function we(){var e=document.getElementById("buttons-div");if(0===e.length)throw Error("Error finding buttons on page!?");return e}function ke(e,t,n){t.onclick=function(){console.log("Button for ".concat(n," clicked!")),e.emit(n)}}function Ee(){var e,t,n=he(pe);try{for(n.s();!(e=n.n()).done;){var o=e.value;document.getElementById(o).onclick=function(){}}}catch(e){n.e(e)}finally{n.f()}!function(){var e,t=we(),n=he(be);try{for(n.s();!(e=n.n()).done;){var o=e.value;t.querySelector("#".concat(o)).onclick=function(){}}}catch(e){n.e(e)}finally{n.f()}}(),(t=document.getElementById("set-goal-button")).classList.add("hidden"),t.onclick=function(){},fe(!1)}var Ie=new Map([["a_flub","Challenge Now"],["p_flub","Challenge Never"],["no_goal","No Goal Declared"]]);function Te(e,t,n,o){n&&(le(Ie.get(n.challenge)),"finished"===n.endgame_stage?Be(e,t,o):"no_goal_finished"===n.endgame_stage?function(e,t,n){n.includes(t)?(_("Click here to restart the shake: "),I(e)):_("Waiting for players to restart the shake...")}(e,t,o):(function(e){var t=e.challenge;if("force_out"===t)_("The players are currently in a Force Out...");else if("no_goal"===t)_("A No Goal has been declared...");else{var n="".concat(e.challenger," has called "),o="".concat(Ie.get(t)," on ").concat(e.last_mover,".");_("".concat(n).concat(o))}}(n),"waiting_for_reviewers"===n.endgame_stage?(xe(e,t,{solutions:n.solutions,players:o}),function(e,t,n){for(var o in n.review_status)if(n.review_status.hasOwnProperty(o))for(var r in n.review_status[o]){if(n.review_status[o].hasOwnProperty(r))"ASSENTING"===n.review_status[o][r]&&Me(e,t,{rejecter:o,writer:r})}}(e,t,n)):"no_goal"==n.challenge?Ce(e,n.caller,n.writers,n.nonwriters,t):(Le(e,n.sider,t),Se(e,n.writers,t))))}function Ce(e,t,n,o,r){r===t?_("Waiting for other player to agree or disagree with your No Goal declaration..."):o.includes(r)?_("Waiting for one more player to agree or disagree with the No Goal declaration..."):n.includes(r)?k(e):function(e,t){_(t+" claims no goal can be set which has at least one correct solution. Do you agree? If not, you can challenge the No Goal declaration and you will have two minutes to write a correct Solution & Goal. Disagreeing with the no goal declaration is considered a challenge, so the first player to disagree (if a player disagrees) will be deemed the challenger.");var n=document.createElement("li");n.classList.add("chat-button");var o=document.createElement("button");o.innerHTML="Agree",n.appendChild(o);var r=document.createElement("button");r.innerHTML="Disagree & Write",n.appendChild(r),o.onclick=function(){e.emit("no_goal_sided",!0),w([o,r]),o.classList.add("button-clicked")},r.onclick=function(){e.emit("no_goal_sided",!1),w([o,r]),r.classList.add("button-clicked"),k(e)},document.getElementById("message-list").appendChild(n)}(e,t)}function Le(e,t,n){null!=t&&(t===n?function(e){_("Do you wish to write a solution? You have one minute to decide.");var t=document.createElement("li");t.classList.add("chat-button");var n=document.createElement("button");n.innerHTML="Yes",t.appendChild(n);var o=document.createElement("button");o.innerHTML="No",t.appendChild(o),n.onclick=function(){e.emit("sided",!0),w([n,o]),n.classList.add("button-clicked"),k(e)},o.onclick=function(){e.emit("sided",!1),w([n,o]),o.classList.add("button-clicked")},document.getElementById("message-list").appendChild(t)}(e):_("Waiting for ".concat(t," to side...")))}function Se(e,t,n){t.includes(n)?k(e):_("Waiting for solutions to be submitted....")}function xe(e,t,n){_("Time to review solutions!");var o=n.solutions,r=n.players,i=!1;for(var a in o)a!==t&&(i=!0,E(e,a,o[a],!1,r.includes(t)));i||_("Waiting for others to finish reviewing solutions...")}function Me(e,t,n){var o=n.rejecter,r=n.writer;r===t?function(e,t){_(t+" rejected your solution. Do you agree?");var n=document.createElement("li");n.classList.add("chat-button");var o=document.createElement("button");o.innerHTML="Yes",n.appendChild(o);var r=document.createElement("button");r.innerHTML="No",n.appendChild(r),o.onclick=function(){e.emit("assented",{rejecter:t,assented:!0}),w([o,r]),o.classList.add("button-clicked")},r.onclick=function(){e.emit("assented",{rejecter:t,assented:!1}),w([o,r]),r.classList.add("button-clicked")},document.getElementById("message-list").appendChild(n)}(e,o):_("Waiting for ".concat(r," to accept the rejection..."))}function Be(e,t,n){n.includes(t)?(_("Click here to start a new shake: "),function(e){var t=document.createElement("li");t.classList.add("chat-button"),p(t,a.a.createElement(m,{buttonText:"Start New Shake",onClick:function(){return e.emit("new_shake")}}))}(e)):_("Waiting for players to start a new shake...")}var He=window.location.protocol.includes("https")?"wss":"ws",qe=r()("".concat(He,"://").concat(window.location.host),{reconnection:!1}),je=new Promise((function(e){qe.on("connect",(function(){console.log("Connected to server!"),e()}))})),Ae=function(){je.then((function(){var e=document.getElementById("room-nonce").innerHTML,t=document.getElementById("name").innerHTML,n={room:e,name:t};!function(e){qe.on("disconnect",(function(){return console.log("disconnected from room")})),qe.on("message",(function(e){return b(e.name,e.message)})),qe.on("server_message",(function(e){return _(e)})),qe.on("render_spectator_state",(function(t){de(t),Te(qe,e,t.endgame,t.players)})),qe.on("render_player_state",(function(t){var n;(de(t),t.game_finished)||(t.game_started?(_e(qe,function(e,t){if(e.players[e.turn]!=t)return!1;if(e.challenge)return!1;if(n=Object.values(ee).reduce((function(e,t){return e+t})),console.log("cubes not in resources: ",n),24-n<2)return!1;var n;if(e.started_move)return!1;var o=e.players.findIndex((function(e){return e===t}));if(-1===o)return console.log("Error! Player not in game in render_player_state"),!1;for(var r=function(e,t){return e+t},i=e["p".concat(o+1,"scores")].reduce(r),a=e.p1scores.reduce(r),c=e.p2scores.reduce(r),l=e.p3scores.reduce(r),s=0,u=0,d=[a,c,l];u<d.length;u++){i>d[u]&&++s}if(2===s)return!1;return!0}(t,e)),ye(qe,e,t.players[t.turn],!t.goalset),Te(qe,e,t.endgame,t.players),console.log("challenge recorded: ",t.challenge),"no_goal"===t.challenge&&ge()):(n=qe,we().querySelector("#start_game").onclick=function(){console.log("Button for start_game clicked!"),n.emit("start_game")},function(e,t,n){if(!t.tournament&&t.players.includes(n)){var o=document.createElement("button");o.innerHTML="Leave Game",o.onclick=function(){e.emit("leave_game")};var r=document.createElement("a");r.id="leave_game_anchor",r.href="/",r.appendChild(o),document.getElementById("buttons-div").appendChild(r)}}(qe,t,e)))})),qe.on("new_player",ae),qe.on("player_left",ae),qe.on("begin_game",(function(t){var n=t.cubes;document.getElementById("start_game").remove(),document.getElementById("leave_game_anchor").remove(),_("".concat(t.starter," started the game! The cubes have been rolled!")),_("".concat(t.goalsetter," is chosen to be the goalsetter.")),y("Server","Move cubes by clicking a cube in resources, then clicking the area on the mat you want to move it to."),y("Server","For goalsetting, once cubes are on the goal line, you can rearrange them (by dragging them horizontally) and rotate them (by right clicking on the cube you want to rotate)."),y("Server","If you can bonus on your turn, a bonus button will appear in the upper right corner of resources. To bonus, first click the bonus button, then move the bonused cube to forbidden, and continue with the rest of your turn."),t.starter===e?_('Press "Goal Set!" when you\'re done!'):_("Waiting for ".concat(t.goalsetter," to finish setting the goal...")),Q(t.starttime),te(n),ce(ae(t.players),0,0,0);var o=t.goalsetter;_e(qe,o===e),le(o),ye(qe,e,o,!0)})),qe.on("begin_shake",(function(t){var n=document.getElementById("new_shake_button");n&&n.remove(),_("A new shake has started! ".concat(t.goalsetter," is chosen to be the goalsetter.")),me(),te(t.cubes);var o=t.goalsetter;_e(qe,o===e&&t.show_bonus),le(o),ye(qe,e,o,!0)})),qe.on("end_shake_no_goal",(function(){return I(qe)})),qe.on("hide_goal_setting_buttons",(function(){return ge()})),qe.on("update_goalline",(function(e){var t,n,o;t=e.type,n=e.order,o=e.new_val,"x_pos"===t?P[n].cube_pos_x=F(o*(T.width/1e3)):"orientation"===t&&(P[n].orientation=o),$()})),qe.on("highlight_cube",(function(e){return t=e,void document.getElementById("r".concat(t)).querySelector("img").classList.add("highlight-img");var t})),qe.on("unhighlight_cube",(function(e){return t=e,void document.getElementById("r".concat(t)).querySelector("img").classList.remove("highlight-img");var t})),qe.on("move_cube",(function(e){return se(e)})),qe.on("next_turn",(function(t){var n=t.player,o=t.show_bonus;le(n),fe(n===e&&o)})),qe.on("handle_challenge",(function(t){return function(e,t,n){var o=n.challenge,r=n.writers,i=n.nonwriters,a=n.caller,c=n.sider;Ee(),le(Ie.get(o)),"no_goal"!==o?(Le(e,c,t),Se(e,r,t)):Ce(e,a,r,i,t)}(qe,e,t)})),qe.on("force_out",(function(t){return function(e,t,n){le("Force Out"),_("It is now Force Out."),n.includes(t)?(Ee(),k(e)):_("Waiting for players to write solutions...")}(qe,e,t)})),qe.on("review_solutions",(function(t){return xe(qe,e,t)})),qe.on("rejection_assent",(function(t){return Me(qe,e,t)})),qe.on("reevaluate_solution",(function(t){return function(e,t,n){var o=n.rejecter,r=n.writer,i=n.solution;if(o===t)E(e,r,i,!0,!0);else{var a="".concat(r," does not agree that his/her solution "),c="is incorrect. Waiting for ".concat(o," to re-evaluate ");_("".concat(a).concat(c).concat("whether the solution is correct..."))}}(qe,e,t)})),qe.on("finish_shake",(function(t){return function(e,t,n,o){var r=n.p1score,i=n.p2score,a=n.p3score,c=n.players;_("This shake has finished! The scoreboard has been updated."),ce(document.getElementById("scoreboard"),r,i,a),o?e.emit("game_over"):Be(e,t,c)}(qe,e,t.scores,t.game_finished)})),qe.on("five_minute_warning_message",(function(){_("".concat("Five minute warning! If the cubes have been rolled, ").concat("continue your game -- you have five minutes left. ").concat("Do not start a new shake."))})),qe.on("game_over_clientside",(function(){_("The game has finished!"),le("Game Ended"),Ee()}))}(t),console.log("Connecting as ".concat(t," in room ").concat(e)),qe.emit("register_client",n)})).catch((function(e){return console.log("Error: ",e)}))};function De(e){var t=document.getElementById("name").innerHTML;qe.emit("new_message",{name:t,message:e})}var Ne=function(e){return qe.emit("cube_clicked",e)};function Oe(){this.classList.toggle("button-clicked"),qe.emit("bonus_clicked")}}}]);