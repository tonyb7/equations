(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{64:function(e,t){},70:function(e,t,n){var o=n(7),r=n(71);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};o(r,i);e.exports=r.locals||{}},71:function(e,t,n){"use strict";n.r(t);var o=n(5),r=n.n(o)()(!1);r.push([e.i,"\n.ChatMessages-module__boldMessageText--1gmuyULK {\n    font-weight: bold;\n    font-style: italics;\n}\n\n.ChatMessages-module__messageSender--pQZAFmiz {\n    font-weight: bold;\n}",""]),r.locals={boldMessageText:"ChatMessages-module__boldMessageText--1gmuyULK",messageSender:"ChatMessages-module__messageSender--pQZAFmiz"},t.default=r},72:function(e,t,n){"use strict";n.r(t),n.d(t,"socket",(function(){return dt})),n.d(t,"connect",(function(){return mt})),n.d(t,"sendChatMessage",(function(){return gt})),n.d(t,"emitCubeClicked",(function(){return ht})),n.d(t,"bonusButtonCallback",(function(){return vt}));var o=n(38),r=n.n(o),i=n(0),a=n.n(i),c=n(4),s=n.n(c),u=n(67),l=n.n(u),d=n(70),f=n.n(d);function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function h(e){var t="instruction"===e.type?f.a.boldMessageText:"";return a.a.createElement(a.a.Fragment,null,a.a.createElement("span",{className:f.a.messageSender},e.name,": "),a.a.createElement("span",{className:t},e.message," "))}function v(e){return a.a.createElement("button",{idName:"new_shake_button",onClick:e.onClick},e.buttonText)}function p(){return a.a.createElement(h,{name:"Server",message:"".concat("Five minute warning! If the cubes have been rolled, ").concat("continue your game -- you have five minutes left. ").concat("Do not start a new shake."),type:"five_min_warning"})}function y(e){var t=m(Object(i.useState)("unselected"),2),n=t[0],o=t[1],r="yes"===n||"no"===n,c={className:"yes"===n?"button-clicked":"",onClick:r?null:function(){o("yes"),e.onYesClick()}},s={className:"no"===n?"button-clicked":"",onClick:r?null:function(){o("no"),e.onNoClick()}};return a.a.createElement(a.a.Fragment,null,a.a.createElement("button",c,"Yes"),a.a.createElement("button",s,"No"))}function _(e){return e.isGamePlayer?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,e.solution),a.a.createElement(y,{onYesClick:e.onYesClick,onNoClick:e.onNoClick})):a.a.createElement("p",null,e.solution)}function b(e){var t=m(Object(i.useState)(""),2),n=t[0],o=t[1],r=m(Object(i.useState)(!1),2),c=r[0],s=r[1],u=["solution_submit"];return c&&u.push("hidden"),a.a.createElement(a.a.Fragment,null,a.a.createElement("input",{className:"solution_box",placeholder:"Type your solution here...",onChange:function(e){return o(e.target.value)},disabled:c}),a.a.createElement("button",{className:u.join(" "),onClick:function(){c||(s(!0),e.onSubmit(n))}},"Submit Solution"))}function w(e){var t=m(Object(i.useState)(""),2),n=t[0],o=t[1],r=m(Object(i.useState)(!1),2),c=r[0],s=r[1],u=["universe_submit"];return c&&u.push("hidden"),a.a.createElement(a.a.Fragment,null,a.a.createElement("input",{className:"universe_box",placeholder:"",onChange:function(e){return o(e.target.value)},maxLength:"2",disabled:c}),a.a.createElement("button",{className:u.join(" "),onClick:function(){c||(s(!0),e.onSubmit(n))}},"Set Universe"))}function k(e,t){document.getElementById("message-list").appendChild(e),s.a.render(t,e);var n=document.getElementById("message-list-div");n.scrollTop=n.scrollHeight}function E(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"player_message",o=document.createElement("li");k(o,a.a.createElement(h,{name:e,message:t,type:n}))}function S(e,t){E(e,t,"instruction")}function C(e){E("Server",e,"server_message")}function I(e){C("Please submit your solution here:");var t=document.createElement("li");t.classList.add("solution_li"),k(t,a.a.createElement(b,{onSubmit:function(t){return e.emit("solution_submitted",t)}}))}function T(e,t,n,o,r){C(r?o?t+" does not agree that the solution is incorrect. Please re-evaluate whether you accept.":t+" submitted the following solution. Do you accept?":t+" submitted the following solution. Waiting for players to accept/reject.");var i=document.createElement("li");i.classList.add("chat-button"),k(i,a.a.createElement(_,{solution:n,isGamePlayer:r,onYesClick:function(){return e.emit("decided",{name:t,accepted:!0})},onNoClick:function(){return e.emit("decided",{name:t,accepted:!1})}}))}function x(e){C("The shake has ended due to a No Goal. Click below to restart the shake.");var t=document.createElement("li");t.classList.add("chat-button"),k(t,a.a.createElement(v,{buttonText:"Restart Shake",onClick:function(){return e.emit("restart_shake")}}))}function L(e){C("Please indicate how many cards you would like to set in the universe:");var t=document.createElement("li");t.classList.add("universe_li"),k(t,a.a.createElement(w,{onSubmit:function(t){return e.emit("universe_set",t)}}))}h.propTypes={name:l.a.string.isRequired,message:l.a.string.isRequired,type:l.a.oneOf(["player_message","server_message","instruction","new_shake","five_min_warning","solution_check","solution_prompt"]).isRequired},h.defaultProps={type:"player_message"},v.propTypes={buttonText:l.a.string.isRequired,onClick:l.a.func.isRequired},y.propTypes={onYesClick:l.a.func.isRequired,onNoClick:l.a.func.isRequired},_.propTypes={solution:l.a.string.isRequired,isGamePlayer:l.a.bool.isRequired,onYesClick:l.a.func,onNoClick:l.a.func},b.propTypes={onSubmit:l.a.func.isRequired},w.propTypes={onSubmit:l.a.func.isRequired};var q,B,M,N,A,j,D,O,H=n(2);function P(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r,i=!0,a=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){a=!0,r=e},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw r}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var W,F,G=!1,Y="eq",z=[];function U(e){Y=e,q=document.getElementById("goal-sector"),$(e),B=q.getBoundingClientRect(),M=B.left,N=B.top,K(e)}function $(e){"eq"===e?(q.width=.33*window.innerWidth,q.height=.09*window.innerHeight):"os"===e&&(q.width=.2*window.innerWidth,q.height=.18*window.innerHeight)}function K(e){"eq"===e?(A=.1*q.width,j=A+3,D=A+2,O=q.height/8):"os"===e&&(A=.2*q.width,j=A,D=A+10,O=q.height/4)}function X(e,t,n){return t>e.cube_pos_x&&t<e.cube_pos_x+j&&n>e.cube_pos_y&&n<e.cube_pos_y+D}function J(e){return e=Math.min(e,q.width-j),e=Math.max(e,4)}function Q(e){return e=Math.min(e,q.height-D),e=Math.max(e,4)}function V(e){e.preventDefault(),e.stopPropagation();var t=parseInt(e.clientX-M),n=parseInt(e.clientY-N);G=!1;for(var o=z.length-1;o>=0;o--){var r=z[o];if(X(r,t,n)){G=!0,r.isDragging=!0;break}}W=t,F=n}function Z(e){e.preventDefault(),e.stopPropagation(),G=!1;for(var t=0;t<z.length;t++)if(z[t].isDragging)return z[t].isDragging=!1,void dt.emit("xy_pos_update",{order:t,x_pos_per_mille:z[t].cube_pos_x/(q.width/1e3),y_pos_per_mille:z[t].cube_pos_y/(q.height/1e3)})}function ee(e){if(G){e.preventDefault(),e.stopPropagation();for(var t=parseInt(e.clientX-M),n=parseInt(e.clientY-N),o=t-W,r=n-F,i=0;i<z.length;i++){var a=z[i];if(a.isDragging){a.cube_pos_x=J(a.cube_pos_x+o),a.cube_pos_y=Q(a.cube_pos_y+r);break}}ne(),W=t,F=n}}function te(e){e.preventDefault(),e.stopPropagation();for(var t=parseInt(e.clientX-M),n=parseInt(e.clientY-N),o=z.length-1;o>=0;o--){var r=z[o];if(X(r,t,n)){r.orientation=(r.orientation+90)%360,dt.emit("orientation_update",{order:o,orientation:r.orientation});break}}return ne(),!1}function ne(){q||U(Y);var e=q.getContext("2d");!function(e){e.clearRect(0,0,q.width,q.height)}(e),e.strokeStyle="#fff",e.lineWidth=2.5;for(var t=0;t<z.length;t++){var n=z[t];oe(e,n.cube,n.cube_pos_x,n.cube_pos_y,A,A,n.orientation)}}function oe(e,t,n,o,r,i,a){e.save(),e.translate(n+r/2,o+i/2),e.rotate(a*Math.PI/180),e.drawImage(t,-r/2,-i/2,r,i),function(e,t,n,o,r,i,a,c){if(void 0===c&&(c=!0),void 0===i&&(i=5),"number"==typeof i)i={tl:i,tr:i,br:i,bl:i};else{var s={tl:0,tr:0,br:0,bl:0};for(var u in s)i[u]=i[u]||s[u]}e.beginPath(),e.moveTo(t+i.tl,n),e.lineTo(t+o-i.tr,n),e.quadraticCurveTo(t+o,n,t+o,n+i.tr),e.lineTo(t+o,n+r-i.br),e.quadraticCurveTo(t+o,n+r,t+o-i.br,n+r),e.lineTo(t+i.bl,n+r),e.quadraticCurveTo(t,n+r,t,n+r-i.bl),e.lineTo(t,n+i.tl),e.quadraticCurveTo(t,n,t+i.tl,n),e.closePath(),a&&e.fill(),c&&e.stroke()}(e,-r/2-1,-i/2-1,r+3,i+2,7),e.restore()}function re(e){e.preventDefault(),e.stopPropagation();var t=q.width,n=q.height;$(Y),B=q.getBoundingClientRect(),M=B.left,N=B.top,K(Y),function(e,t){for(var n=0;n<z.length;n++)z[n].cube_pos_x=J(z[n].cube_pos_x*(q.width/e)),z[n].cube_pos_y=Q(z[n].cube_pos_y*(q.height/t)),dt.emit("xy_pos_update",{order:n,x_pos_per_mille:z[n].cube_pos_x/(q.width/1e3),y_pos_per_mille:z[n].cube_pos_y/(q.height/1e3)})}(t,n),ne()}var ie=new Map([["forbidden-sector","f"],["permitted-sector","p"],["required-sector","q"],["goal-sector","g"]]),ae={"forbidden-sector":0,"permitted-sector":0,"required-sector":0,"goal-sector":0},ce=new Map([["eq",24],["os",18]]);function se(e){e.game_started&&(console.assert(e.cube_index.length>0),function(e){e.game_started&&(U(e.gametype),e.goalset&&ge())}(e),function(e,t,n){t.length>6&&console.log("Something is wrong! Server stored more than 6 cubes in goal!");ae["goal-sector"]=t.length,function(e,t,n){window.onresize=re;var o,r=P(t);try{for(r.s();!(o=r.n()).done;){var i=o.value,a=H.b.get(e);a(i.idx,n).onload=ne;var c=J(i.x*q.width/1e3),s=O;"y"in i&&(s=Q(i.y*q.width/1e3)),z.push({order:z.length,idx:i.idx,cube:a(i.idx,n),cube_pos_x:c,cube_pos_y:s,isDragging:!1,orientation:i.orientation})}}catch(e){r.e(e)}finally{r.f()}}(e,t,n)}(e.gametype,e.goal,e.cube_index),ue(e.gametype,e.resources),le(e.gametype,e.forbidden,"forbidden-sector",e.cube_index),le(e.gametype,e.permitted,"permitted-sector",e.cube_index),le(e.gametype,e.required,"required-sector",e.cube_index))}function ue(e,t){console.log("Rolling cubes!");for(var n=document.getElementById("resources-cubes"),o=function(o){if(-1===t[o])return"continue";var r=n.querySelector("#r".concat(o)),i=H.b.get(e)(o,t);i.onmouseover=function(){i.classList.add("show-border")},i.onmouseout=function(){i.classList.remove("show-border")},i.onclick=function(){return ht(o)},r.appendChild(i)},r=0;r<ce.get(e);++r)o(r);console.log("Finished rolling cubes")}function le(e,t,n,o){for(var r=0,i=[12,16,20];r<i.length;r++){var a=i[r];t.length>a&&fe(n,a)}ae[n]=t.length,function(e,t,n,o){for(var r=0;r<t.length;++r){var i=document.getElementById("".concat(ie.get(n)).concat(r)),a=t[r],c=H.b.get(e);i.appendChild(c(a,o))}}(e,t,n,o)}function de(e){var t=e.from,n=ae[e.to],o="".concat(ie.get(e.to)).concat(n);12!==n&&16!==n&&20!==n||fe(e.to,n),ae[e.to]++;var r=document.getElementById("resources-cubes").querySelector("#r".concat(t)).querySelector("img");r.onmouseover=function(){},r.onmouseout=function(){},r.onclick=function(){},r.classList.remove("highlight-img"),"goal-sector"===e.to?function(e,t){var n=q.width/100;0!==z.length&&(n+=z.length*(3*n+j));var o=O,r=z.length;z.push({order:r,idx:e,cube:t.cloneNode(!0),cube_pos_x:n,cube_pos_y:o,isDragging:!1,orientation:0}),t.remove(),dt.emit("xy_pos_update",{order:r,x_pos_per_mille:n/(q.width/1e3),y_pos_per_mille:o/(q.height/1e3)}),ne()}(e.from,r):document.getElementById(o).appendChild(r),me(!1)}function fe(e,t){for(var n=document.getElementById(e).querySelector("table").insertRow(),o=0;o<4;++o){n.insertCell().id="".concat(ie.get(e)).concat(t+o)}}function me(e){var t=document.getElementById("bonus-button");t.classList.remove("button-clicked"),e?(t.classList.remove("hidden"),t.onclick=vt.bind(t)):(t.classList.add("hidden"),t.onclick=function(){})}function ge(){var e=document.getElementById("no_goal");e.classList.add("hidden"),e.onclick=function(){return console.log("No goal challenge somehow clicked...")};var t=document.getElementById("set-goal-button");t.classList.add("hidden"),t.onclick=function(){return console.log("Set goal button somehow clicked...")},q.onmousedown=function(){},q.onmouseup=function(){},q.onmousemove=function(){},q.oncontextmenu=function(){}}function he(e){for(var t=document.getElementById("scoreboard"),n=0;n<e.length;++n)t.rows[0].cells.item(n).innerHTML=e[n];for(var o=e.length;o<3;++o)t.rows[0].cells.item(o).innerHTML="--------";return t}function ve(e,t,n,o){2===e.rows.length&&0==e.rows[1].cells[0].innerHTML&&e.deleteRow(1);var r=e.insertRow();r.insertCell().innerHTML=t,r.insertCell().innerHTML=n,r.insertCell().innerHTML=o}function pe(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r,i=!0,a=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){a=!0,r=e},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw r}}}}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function _e(e,t){var n;e.game_started||(n=dt,be().querySelector("#start_game").onclick=function(){console.log("Button for start_game clicked!"),n.emit("start_game")},function(e,t,n){if(!t.tournament&&t.players.includes(n)){var o=document.createElement("button");o.innerHTML="Leave Game",o.onclick=function(){e.emit("leave_game")};var r=document.createElement("a");r.id="leave_game_anchor",r.href="/",r.appendChild(o),document.getElementById("buttons-div").appendChild(r)}}(dt,e,t))}function be(){var e=document.getElementById("buttons-div");if(0===e.length)throw Error("Error finding buttons on page!?");return e}var we=["flip_timer","claim_warning","claim_minus_one","a_flub","p_flub","no_goal"];function ke(e,t,n){t.onclick=function(){console.log("Button for ".concat(n," clicked!")),e.emit(n)}}var Ee=function(e,t,n,o){if(U(o),window.onresize=re,n&&t===e){var r=document.getElementById("set-goal-button");r.classList.remove("hidden"),r.onclick=function(){dt.emit("set_goal")},q.onmousedown=V,q.onmouseup=Z,q.onmousemove=ee,q.oncontextmenu=te}};function Se(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r,i=!0,a=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){a=!0,r=e},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw r}}}}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var Ie=["forbidden-sector","permitted-sector","required-sector","goal-sector"];function Te(e,t){e.game_started&&xe(e.players.includes(t),function(e,t){if(e.players[e.turn]!=t)return!1;if(e.challenge)return!1;if(n=e.gametype,o=Object.values(ae).reduce((function(e,t){return e+t})),ce.get(n)-o<2)return!1;var n,o;if(e.started_move)return!1;var r=e.players.findIndex((function(e){return e===t}));if(-1===r)return console.log("Error! Player not in game in render_player_state"),!1;for(var i=function(e,t){return e+t},a=e["p".concat(r+1,"scores")].reduce(i),c=e.p1scores.reduce(i),s=e.p2scores.reduce(i),u=e.p3scores.reduce(i),l=0,d=0,f=[c,s,u];d<f.length;d++){a>f[d]&&++l}if(2===l)return!1;return!0}(e,t))}function xe(e,t){if(e){var n,o=Se(Ie);try{var r=function(){var e=n.value;document.getElementById(e).onclick=function(){console.log("".concat(e," clicked")),dt.emit("sector_clicked",e)}};for(o.s();!(n=o.n()).done;)r()}catch(e){o.e(e)}finally{o.f()}!function(e){var t,n=be(),o=pe(we);try{for(o.s();!(t=o.n()).done;){var r=t.value;ke(e,n.querySelector("#".concat(r)),r)}}catch(e){o.e(e)}finally{o.f()}}(dt),me(t)}}function Le(){var e,t,n=Se(Ie);try{for(n.s();!(e=n.n()).done;){var o=e.value;document.getElementById(o).onclick=function(){}}}catch(e){n.e(e)}finally{n.f()}!function(){var e,t=be(),n=pe(we);try{for(n.s();!(e=n.n()).done;){var o=e.value;t.querySelector("#".concat(o)).onclick=function(){}}}catch(e){n.e(e)}finally{n.f()}}(),(t=document.getElementById("set-goal-button")).classList.add("hidden"),t.onclick=function(){},me(!1)}function qe(e){document.getElementById("actual-turn-text").innerHTML="".concat(e)}var Be,Me,Ne,Ae=new Map([["a_flub","Challenge Now"],["p_flub","Challenge Impossible"],["no_goal","No Goal Declared"],["force_out","Last Cube Procedure"]]);function je(e,t){!function(e,t,n,o){if(!n)return;qe(Ae.get(n.challenge)),"finished"===n.endgame_stage?We(e,t,o):"no_goal_finished"===n.endgame_stage?function(e,t,n){n.includes(t)?(C("Click here to restart the shake: "),x(e)):C("Waiting for players to restart the shake...")}(e,t,o):(function(e){var t=e.challenge;if("force_out"===t)C("The players are currently in a Force Out...");else if("no_goal"===t)C("A No Goal has been declared...");else{var n="".concat(e.challenger," has called "),o="".concat(Ae.get(t)," on ").concat(e.last_mover,".");C("".concat(n).concat(o))}}(n),"waiting_for_reviewers"===n.endgame_stage?(Pe(e,t,{solutions:n.solutions,players:o}),function(e,t,n){for(var o in n.review_status)if(n.review_status.hasOwnProperty(o))for(var r in n.review_status[o]){if(n.review_status[o].hasOwnProperty(r))"ASSENTING"===n.review_status[o][r]&&Re(e,t,{rejecter:o,writer:r})}}(e,t,n)):"no_goal"==n.challenge?De(e,n.caller,n.writers,n.nonwriters,t):(Oe(e,n.sider,t),He(e,n.writers,t)))}(dt,t,e.endgame,e.players),e.game_started&&"no_goal"===e.challenge&&ge()}function De(e,t,n,o,r){r===t?C("Waiting for other player to agree or disagree with your No Goal declaration..."):o.includes(r)?C("Waiting for one more player to agree or disagree with the No Goal declaration..."):n.includes(r)?I(e):function(e,t){C(t+" claims no goal can be set which has at least one correct solution. Do you agree? If not, you can challenge the No Goal declaration and you will have two minutes to write a correct Solution & Goal. Disagreeing with the no goal declaration is considered a challenge, so the first player to disagree (if a player disagrees) will be deemed the challenger.");var n=document.createElement("li");n.classList.add("chat-button"),k(n,a.a.createElement(y,{onYesClick:function(){return e.emit("no_goal_sided",!0)},onNoClick:function(){e.emit("no_goal_sided",!1),I(e)}}))}(e,t)}function Oe(e,t,n){null!=t&&(t===n?function(e){C("Do you wish to write a solution? You have one minute to decide.");var t=document.createElement("li");t.classList.add("chat-button"),k(t,a.a.createElement(y,{onYesClick:function(){e.emit("sided",!0),I(e)},onNoClick:function(){return e.emit("sided",!1)}}))}(e):C("Waiting for ".concat(t," to side...")))}function He(e,t,n){t.includes(n)?I(e):C("Waiting for solutions to be submitted....")}function Pe(e,t,n){C("Time to review solutions!");var o=n.solutions,r=n.players,i=!1;for(var a in o)a!==t&&(i=!0,T(e,a,o[a],!1,r.includes(t)));i||C("Waiting for others to finish reviewing solutions...")}function Re(e,t,n){var o=n.rejecter,r=n.writer;r===t?function(e,t){C(t+" rejected your solution. Do you agree?");var n=document.createElement("li");n.classList.add("chat-button"),k(n,a.a.createElement(y,{onYesClick:function(){return e.emit("assented",{rejecter:t,assented:!0})},onNoClick:function(){return e.emit("assented",{rejecter:t,assented:!1})}}))}(e,o):C("Waiting for ".concat(r," to accept the rejection..."))}function We(e,t,n){n.includes(t)?(C("Click here to start a new shake: "),function(e){var t=document.createElement("li");t.classList.add("chat-button"),k(t,a.a.createElement(v,{buttonText:"Start New Shake",onClick:function(){return e.emit("new_shake")}}))}(e)):C("Waiting for players to start a new shake...")}var Fe,Ge=!1;function Ye(e){Me||(Me=document.getElementById("elapsed")),Me.innerHTML=e}function ze(e){Ne||(Ne=document.getElementsByClassName("display-time-div")[0]),Ne.innerHTML="<p>".concat(e,"</p>")}function Ue(e){Be=e;var t=setInterval((function(){var e=new Date,n=Math.round(e.getTime()/1e3)-Be,o=Math.floor(n/60),r=Math.floor(n%60),i="";o<10&&(i="0");var a="";r<10&&(a="0");var c="".concat(i).concat(o,":").concat(a).concat(r);o>=30&&!Ge&&(Ge=!0,dt.emit("five_minute_warning")),o>=35&&(clearInterval(t),dt.emit("game_time_up"),c="35:00"),Ye(c)}),1e3)}function $e(e){e&&(clearInterval(Fe),Fe=setInterval((function(){var t=new Date,n=60-Math.floor(t.getTime()/1e3-e),o="";n<10&&(o="0");var r="0:".concat(o).concat(n);n<=0&&(clearInterval(Fe),r="0:00"),ze(r)}),1e3))}function Ke(e,t){e.game_started&&("os"==e.gametype&&0==e.onsets_cards_dealt||Xe(e.variations_state,e.players,t,e.game_finished))}function Xe(e,t,n,o){var r=document.getElementById("variations");if(r.classList.remove("hidden"),r.querySelector("#called-variations").innerHTML=e.variations.join(", "),!o)if(e.num_players_called<t.length)if(qe("Calling Variations"),t[e.caller_index]===n){var i=document.getElementById("variations-input-div");i.classList.remove("hidden");var a=i.getElementsByTagName("button")[0];a.onclick=function(){var e=i.getElementsByTagName("input")[0];dt.emit("variation_called",{player:n,content:e.value}),e.value="",i.classList.add("hidden"),a.onclick=function(){}},C('It is your turn to call variations. Please enter the variations you want to call in the text box to the left (in the "Variations" section), and hit "Submit" when you are done!')}else C("It is ".concat(t[e.caller_index],"'s turn to call variations. Waiting \n                for ").concat(t[e.caller_index]," to finish calling variations..."));else console.log("The variation calling stage has already finished")}function Je(e,t){e.is_first_shake&&(S("Server","All the players have called variations. Now it is time to set the goal. Before you start, here are some basic instructions."),S("Server","Move cubes by clicking a cube in resources, then clicking the area on the mat you want to move it to."),S("Server","For goalsetting, once cubes are on the goal line, you can rearrange them (by dragging them horizontally) and rotate them (by right clicking on the cube you want to rotate)."),S("Server","If you can bonus on your turn, a bonus button will appear in the upper right corner of resources. To bonus, first click the bonus button, then move the bonused cube to forbidden, and continue with the rest of your turn."),e.goalsetter===t?C('Press "Goal Set!" when you\'re done!'):C("Waiting for ".concat(e.goalsetter," to finish setting the goal..."))),qe(e.goalsetter)}var Qe=n(1);function Ve(e,t){e!=t?C("Waiting for ".concat(t," to set the universe...")):L(dt)}function Ze(e,t){console.log("Displaying On-Sets Universe");for(var n=document.getElementById("resources-cards"),o=0;o<e;++o){var r=n.querySelector("#c".concat(o)),i=Object(Qe.c)(t[o]);r.appendChild(i)}console.log("Finished displaying On-Sets universe")}function et(){document.getElementById("start_game").remove();var e=document.getElementById("leave_game_anchor");e&&e.remove()}function tt(){console.log("Clearing board"),z.length=0,ne(),ae["goal-sector"]=0;for(var e=0,t=["forbidden-sector","permitted-sector","required-sector"];e<t.length;e++){nt(t[e])}!function(){for(var e=document.getElementById("resources-cubes"),t=0;t<24;++t){e.querySelector("#r".concat(t)).innerHTML=""}}()}function nt(e){for(var t=document.getElementById(e).querySelector("table"),n=t.rows.length-1;n>=3;--n)t.deleteRow(n);for(var o=0;o<12;++o){t.querySelector("#".concat(ie.get(e)).concat(o)).innerHTML=""}ae[e]=0}function ot(e,t){tt(),ue(e.gametype,e.cubes),Xe(e.variations_state,e.players,t,!1),xe(e.players.includes(t),e.goalsetter===t&&e.show_bonus),Ee(t,e.goalsetter,!0,e.gametype)}function rt(e,t,n){tt(),function(){for(var e=document.getElementById("resources-cards"),t=0;t<18;++t){e.querySelector("#c".concat(t)).innerHTML=""}}(),ue(e.gametype,e.cubes),Ve(t,n),xe(e.players.includes(t),e.goalsetter===t&&e.show_bonus),Ee(t,e.goalsetter,!0,e.gametype)}function it(e,t){et(),"eq"==e.gametype?function(e,t){C("".concat(e.starter," started the game! The cubes have been rolled!")),C("".concat(e.goalsetter," is chosen to be the goal-setter.")),ve(he(e.players),0,0,0),Ue(e.starttime),ot(e,t)}(e,t):"os"==e.gametype?function(e,t){var n=e.cardsetter;C("".concat(e.starter," started the game! The cubes have been rolled!")),C("".concat(e.goalsetter," is chosen to be the goal-setter.")),C("".concat(n," must choose how many cards to deal in the universe.")),ve(he(e.players),0,0,0),Ue(e.starttime),rt(e,t,n)}(e,t):console.log("Error: Can't begin game, unrecognized game type ".concat(e.gametype))}function at(e,t){var n;(n=document.getElementById("new_shake_button"))&&n.remove(),"eq"==e.gametype?function(e,t){C("A new shake has started! ".concat(e.goalsetter," is chosen to be the goalsetter.")),ot(e,t)}(e,t):"os"==e.gametype?function(e,t){C("A new shake has started! ".concat(e.goalsetter," is chosen to be the goalsetter.")),rt(e,t,e.cardsetter)}(e,t):console.log("Error: Can't begin shake, unrecognized game type ".concat(e.gametype))}function ct(e,t){"eq"==e.gametype?Ke(e,t):"os"==e.gametype&&(!function(e,t){if(console.assert("os"==e.gametype),e.game_started)if(e.onsets_cards_dealt>0)Ze(e.onsets_cards_dealt,e.onsets_cards);else{if(e.game_finished)return;var n=e.players.length,o=(e.turn-1)%n;o=(o+n)%n,Ve(t,e.players[o])}}(e,t),Ke(e,t))}function st(e,t){!function(e){var t=he(e.players),n=e.p1scores,o=e.p2scores,r=e.p3scores;if(void 0!==n){n.length===o.length&&o.length==r.length||console.log("Something is messed up with the scores! Player scores are not of same length!");for(var i=0;i<n.length;++i)ve(t,n[i],o[i],r[i])}}(e),function(e){e.game_finished?qe("Game Ended"):e.game_started?qe(e.players[e.turn]):qe("Not Started")}(e),function(e){e.game_finished?(Ye("35:00"),ze("0:00")):e.game_started?(Ue(e.starttime),$e(e.last_timer_flip)):(Ye("00:00"),ze("0:00"))}(e),function(e){e.game_started&&et()}(e),se(e),ct(e,t),je(e,t)}function ut(e,t){st(e,t),_e(e,t),function(e,t){e.game_started&&Ee(t,e.players[e.turn],!e.goalset,e.gametype)}(e,t),Te(e,t)}var lt=window.location.protocol.includes("https")?"wss":"ws",dt=r()("".concat(lt,"://").concat(window.location.host),{reconnection:!1}),ft=new Promise((function(e){dt.on("connect",(function(){console.log("Connected to server!"),e()}))})),mt=function(){ft.then((function(){var e=document.getElementById("room-nonce").innerHTML,t=document.getElementById("name").innerHTML,n={room:e,name:t};!function(e){dt.on("disconnect",(function(){return console.log("disconnected from room")})),dt.on("message",(function(e){return E(e.name,e.message)})),dt.on("server_message",(function(e){return C(e)})),dt.on("render_spectator_state",(function(t){return st(t,e)})),dt.on("render_player_state",(function(t){return ut(t,e)})),dt.on("new_player",he),dt.on("player_left",he),dt.on("begin_game",(function(t){return it(t,e)})),dt.on("begin_shake",(function(t){return at(t,e)})),dt.on("next_turn",(function(t){return function(e,t){var n=e.player,o=e.show_bonus;qe(n),me(n===t&&o)}(t,e)})),dt.on("game_over_clientside",(function(){return C("The game has finished!"),qe("Game Ended"),void Le()})),dt.on("end_shake_no_goal",(function(){return x(dt)})),dt.on("hide_goal_setting_buttons",(function(){return ge()})),dt.on("update_goalline",(function(e){return t=e.type,n=e.order,o=e.new_val,"xy_pos"===t?(z[n].cube_pos_x=J(o[0]*(q.width/1e3)),z[n].cube_pos_y=Q(o[1]*(q.height/1e3))):"orientation"===t&&(z[n].orientation=o),void ne();var t,n,o})),dt.on("highlight_cube",(function(e){return t=e,void document.getElementById("r".concat(t)).querySelector("img").classList.add("highlight-img");var t})),dt.on("unhighlight_cube",(function(e){return t=e,void document.getElementById("r".concat(t)).querySelector("img").classList.remove("highlight-img");var t})),dt.on("move_cube",(function(e){return de(e)})),dt.on("handle_challenge",(function(t){return function(e,t,n){var o=n.challenge,r=n.writers,i=n.nonwriters,a=n.caller,c=n.sider;Le(),qe(Ae.get(o)),"no_goal"!==o?(Oe(e,c,t),He(e,r,t)):De(e,a,r,i,t)}(dt,e,t)})),dt.on("force_out",(function(t){return function(e,t,n){qe("Force Out"),C("It is now Force Out."),n.includes(t)?(Le(),I(e)):C("Waiting for players to write solutions...")}(dt,e,t)})),dt.on("review_solutions",(function(t){return Pe(dt,e,t)})),dt.on("rejection_assent",(function(t){return Re(dt,e,t)})),dt.on("reevaluate_solution",(function(t){return function(e,t,n){var o=n.rejecter,r=n.writer,i=n.solution;if(o===t)T(e,r,i,!0,!0);else{var a="".concat(r," does not agree that his/her solution "),c="is incorrect. Waiting for ".concat(o," to re-evaluate ");C("".concat(a).concat(c).concat("whether the solution is correct..."))}}(dt,e,t)})),dt.on("finish_shake",(function(t){return function(e,t,n,o){console.log("HANDLE SHAKE FINISH");var r=n.p1score,i=n.p2score,a=n.p3score,c=n.players;C("This shake has finished! The scoreboard has been updated."),ve(document.getElementById("scoreboard"),r,i,a),o?e.emit("game_over"):We(e,t,c)}(dt,e,t.scores,t.game_finished)})),dt.on("five_minute_warning_message",(function(){k(document.createElement("li"),a.a.createElement(p,null))})),dt.on("update_variations",(function(t){return Xe(t.variations_state,t.players,e,!1)})),dt.on("variations_finished",(function(t){return Je(t,e)})),dt.on("timer_flip",(function(e){return function(e){C("".concat(e.flipper," flipped the timer.")),$e(e.last_timer_flip)}(e)})),dt.on("universe_set",(function(t){return function(e,t){var n=e.cardsetter,o=e.numCards,r=e.onsets_cards;C("".concat(n," set ").concat(o," cards in the universe!")),Ze(o,r),C("It is now time to call variations."),Xe(e.variations_state,e.players,t,!1)}(t,e)})),dt.on("universe_error",(function(t){return function(e,t){var n=e.cardsetter,o=e.numCardsStr;n==t?(C("You tried to set a universe with '".concat(o,"' cards, which is invalid.")),C("If you are not in Senior Division, please set a universe between 6 and 12 cards."),C("If you are in Senior Division, please set a universe between 10 and 14 cards."),L(dt)):(C("".concat(n," tried to set '").concat(o,"' cards in the universe, which is invalid.")),C("Waiting for ".concat(n," to set a universe with valid size...")))}(t,e)}))}(t),console.log("Connecting as ".concat(t," in room ").concat(e)),dt.emit("register_client",n)})).catch((function(e){return console.log("Error: ",e)}))};function gt(e){var t=document.getElementById("name").innerHTML;dt.emit("new_message",{name:t,message:e})}var ht=function(e){return dt.emit("cube_clicked",e)};function vt(){this.classList.toggle("button-clicked"),dt.emit("bonus_clicked")}}}]);